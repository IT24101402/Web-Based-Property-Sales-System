<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Users | Admin</title>
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@500;700&display=swap" rel="stylesheet">
  <script>tailwind.config={theme:{extend:{colors:{primary:"#2E8B57"}}}}</script>
</head>
<body class="font-display bg-[#edf5ed] text-gray-800">
<div class="flex min-h-screen">
  <aside class="w-64 bg-white p-4 shadow-md">
    <nav class="space-y-2">
      <a href="/admin/dashboard" class="block py-2">🏠 Dashboard</a>
      <a href="/admin/users" class="block py-2 bg-primary/10 rounded font-semibold">👤 Users</a>
      <a href="/admin/feedbacks" class="block py-2">💬 Feedbacks</a>
      <a href="/admin/properties" class="block py-2">🏘 Properties</a>
      <a href="/admin/payments" class="block py-2">💳 Payments</a>
    </nav>
  </aside>

  <main class="flex-1 p-8">
    <h1 class="text-2xl font-bold mb-6">Registered Users</h1>

    <!-- Filters -->
    <form method="get" class="flex gap-4 mb-6 flex-wrap">
      <select name="role" class="rounded border-gray-300" onchange="this.form.submit()">
        <option value="all" th:selected="${selectedRole=='all'}">All Roles</option>
        <option value="buyer" th:selected="${selectedRole=='buyer'}">Buyer</option>
        <option value="vendor" th:selected="${selectedRole=='vendor'}">Vendor</option>
        <option value="tenant" th:selected="${selectedRole=='tenant'}">Tenant</option>
      </select>
      <input type="text" name="search" th:value="${search}" placeholder="Search by email" class="rounded border-gray-300 flex-1">
      <button class="bg-primary text-white px-4 py-2 rounded">Search</button>
    </form>

    <!-- Table -->
    <div class="overflow-x-auto bg-white rounded-lg shadow">
      <table class="min-w-full">
        <thead class="bg-primary text-white">
        <tr>
          <th class="px-4 py-2 text-left">Name</th>
          <th class="px-4 py-2 text-left">Email</th>
          <th class="px-4 py-2 text-left">Role</th>
          <th class="px-4 py-2 text-left">Status</th>
          <th class="px-4 py-2 text-left">Registered</th>
          <th class="px-4 py-2 text-center">Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="u : ${users}" class="border-b hover:bg-gray-50">
          <td class="px-4 py-2" th:text="${u.username}"></td>
          <td class="px-4 py-2" th:text="${u.email}"></td>
          <td class="px-4 py-2 capitalize" th:text="${u.role}"></td>
          <td class="px-4 py-2" th:text="${u.status} ? 'Active' : 'Inactive'"
              th:classappend="${u.status} ? 'text-green-600' : 'text-red-600'"></td>
          <td class="px-4 py-2" th:text="${#temporals.format(u.registeredDate,'yyyy-MM-dd')}"></td>
          <td class="px-4 py-2 text-center">
            <div class="flex justify-center gap-3">
              <a th:href="@{'/admin/users/edit/' + ${u.id}}"
                 class="bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700 transition">Edit</a>
              <a th:href="@{'/admin/users/delete/' + ${u.id}}"
                 onclick="return confirm('Are you sure you want to delete this user?');"
                 class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700 transition">Delete</a>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

    <!-- No users message -->
    <div th:if="${#lists.isEmpty(users)}" class="text-center py-8 text-gray-500 font-medium">
      No users found.
    </div>
  </main>
</div>
</body>
</html>
